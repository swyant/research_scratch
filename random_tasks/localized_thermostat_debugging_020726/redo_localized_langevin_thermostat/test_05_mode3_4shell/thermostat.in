# Localized thermostat simulation (mode 3)
# Generated by localized_thermostat

units metal
atom_style atomic
boundary p p p

read_data thermostat.data

neighbor 2.0 bin
neigh_modify every 1 delay 0 check yes

pair_style pod
pair_coeff * * HfO2_param.pod HfO2_coefficients.pod Hf O

# --- Group definitions (hybrid: ID-based mobile, frozen = rest) ---
group mobile id 809 1093 1096 1097 1098 1100 1101 1104 1129 1130 1132 1133 1134 1135 1136 1137 1138 1140 1141 1165 1166 1169 1170 1172 1173 1174 1384 1385 1388 1392 1417 1418 1419 1420 1421 1422 1423 1424 1425 1426 1427 1428 1429 1432 1449 1450 1451 1452 1453 1454 1455 1456 1457 1458 1459 1460 1461 1462 1463 1464 1465 1466 1468 1485 1486 1489 1490 1491 1492 1493 1494 1495 1496 1497 1498 1499 1500 1501 1525 1526 1529 1530 1533 1534 1705 1706 1707 1708 1709 1710 1711 1712 1713 1715 1716 1720 1737 1738 1739 1740 1741 1742 1743 1744 1745 1746 1747 1748 1749 1750 1751 1752 1753 1754 1755 1756 1773 1774 1775 1776 1777 1778 1779 1780 1781 1782 1783 1784 1785 1786 1787 1788 1789 1790 1791 1792 1793 1809 1810 1811 1812 1813 1814 1815 1816 1817 1818 1819 1820 1821 1822 1823 1824 1825 1826 1828 1846 1849 1850 1853 1854 1855 1856 1857 1858 1861 2027 2028 2029 2030 2031 2032 2033 2034 2035 2036 2037 2038 2039 2040 2044 2061 2062 2063 2064 2065 2066 2067 2068 2069 2070 2071 2072 2073 2074 2075 2076 2077 2078 2079 2080 2084 2094 2095 2097 2098 2099 2100 2101 2102 2103 2104 2105 2106 2107 2108 2109 2110 2111 2112 2113 2114 2115 2116 2117 2120 2130 2133 2134 2135 2136 2137 2138 2139 2140 2141 2142 2143 2144 2145 2146 2147 2148 2149 2150 2151 2152 2153 2170 2173 2174 2175 2176 2177 2178 2179 2180 2181 2182 2183 2184 2185 2186 2324 2351 2352 2353 2354 2355 2356 2357 2358 2359 2360 2361 2362 2363 2364 2368 2383 2385 2386 2387 2388 2389 2390 2391 2392 2393 2394 2395 2396 2397 2398 2399 2400 2401 2402 2403 2404 2408 2418 2419 2421 2422 2423 2424 2425 2426 2427 2428 2429 2430 2431 2432 2433 2434 2435 2436 2437 2438 2439 2440 2441 2444 2454 2457 2458 2459 2460 2461 2462 2463 2464 2465 2466 2467 2468 2469 2470 2471 2472 2473 2474 2475 2476 2477 2494 2497 2498 2499 2500 2501 2502 2503 2504 2505 2506 2507 2508 2509 2510 2538 2675 2676 2677 2678 2679 2680 2681 2682 2683 2684 2685 2686 2687 2688 2692 2707 2709 2710 2711 2712 2713 2714 2715 2716 2717 2718 2719 2720 2721 2722 2723 2724 2725 2726 2727 2728 2732 2742 2743 2745 2746 2747 2748 2749 2750 2751 2752 2753 2754 2755 2756 2757 2758 2759 2760 2761 2762 2763 2764 2765 2768 2778 2781 2782 2783 2784 2785 2786 2787 2788 2789 2790 2791 2792 2793 2794 2795 2796 2797 2798 2799 2800 2818 2821 2822 2823 2824 2825 2826 2827 2828 2829 2830 2831 2832 2833 2834 2999 3002 3003 3004 3005 3006 3007 3008 3009 3011 3012 3016 3034 3035 3036 3037 3038 3039 3040 3041 3042 3043 3044 3045 3046 3047 3048 3049 3050 3051 3052 3067 3069 3070 3071 3072 3073 3074 3075 3076 3077 3078 3079 3080 3081 3082 3083 3084 3085 3086 3087 3088 3105 3106 3107 3108 3109 3110 3111 3112 3113 3114 3115 3116 3117 3118 3119 3120 3121 3122 3123 3124 3142 3145 3146 3147 3149 3150 3151 3152 3153 3154 3155 3327 3328 3331 3332 3335 3336 3359 3361 3362 3363 3364 3365 3366 3367 3368 3369 3370 3371 3372 3375 3376 3394 3395 3396 3397 3398 3399 3400 3401 3402 3403 3404 3405 3406 3407 3408 3409 3410 3411 3412 3430 3431 3433 3434 3435 3436 3437 3438 3439 3440 3441 3442 3443 3444 3470 3474 3475 3478 3687 3688 3690 3691 3692 3695 3696 3719 3722 3723 3724 3725 3726 3727 3728 3729 3730 3731 3732 3758 3759 3762 3763 3764 3766 3767 4047 4051 4861
group frozen subtract all mobile

# --- Region definitions ---
region reg_core sphere 24.14 25.07 22.58 5.0 side in
region reg_shell1_inner sphere 24.14 25.07 22.58 5.0 side out
region reg_shell1_outer sphere 24.14 25.07 22.58 7.5 side in
region reg_shell1 intersect 2 reg_shell1_inner reg_shell1_outer
region reg_shell2_inner sphere 24.14 25.07 22.58 7.5 side out
region reg_shell2_outer sphere 24.14 25.07 22.58 10.0 side in
region reg_shell2 intersect 2 reg_shell2_inner reg_shell2_outer
region reg_shell3_inner sphere 24.14 25.07 22.58 10.0 side out
region reg_shell3_outer sphere 24.14 25.07 22.58 12.5 side in
region reg_shell3 intersect 2 reg_shell3_inner reg_shell3_outer
region reg_shell4_inner sphere 24.14 25.07 22.58 12.5 side out
region reg_shell4_outer sphere 24.14 25.07 22.58 15.0 side in
region reg_shell4 intersect 2 reg_shell4_inner reg_shell4_outer

# --- Dynamic groups (re-evaluated every N steps) ---
group dyn_core dynamic mobile region reg_core every 100
group dyn_shell1 dynamic mobile region reg_shell1 every 100
group dyn_shell2 dynamic mobile region reg_shell2 every 100
group dyn_shell3 dynamic mobile region reg_shell3 every 100
group dyn_shell4 dynamic mobile region reg_shell4 every 100

# --- Frozen atoms ---
velocity frozen set 0.0 0.0 0.0
fix freeze frozen setforce 0.0 0.0 0.0
# neigh_modify exclude omitted (crashes with pair_style pod)

# --- Time integration (must exist before run 0) ---
fix integ mobile nve
timestep 0.001

# --- Populate dynamic groups via run 0 ---
run 0

# --- Per-zone velocity initialization ---
velocity dyn_core create 500.0 38500 dist gaussian
velocity dyn_shell1 create 450.0 38501 dist gaussian
velocity dyn_shell2 create 350.0 38502 dist gaussian
velocity dyn_shell3 create 250.0 38503 dist gaussian
velocity dyn_shell4 create 150.0 38504 dist gaussian

# --- Langevin thermostats ---
fix lang_core dyn_core langevin 500.0 500.0 0.1 38600
fix lang_dyn_shell1 dyn_shell1 langevin 450.0 450.0 0.1 38601
fix lang_dyn_shell2 dyn_shell2 langevin 350.0 350.0 0.1 38602
fix lang_dyn_shell3 dyn_shell3 langevin 250.0 250.0 0.1 38603
fix lang_dyn_shell4 dyn_shell4 langevin 150.0 150.0 0.1 38604

# --- Diagnostics ---
shell mkdir diagnostics
compute ke_per_atom all ke/atom
dump diag_traj mobile custom 500 diagnostics/ke_trajectory.lammpstrj id type x y z c_ke_per_atom
dump_modify diag_traj sort id format line "%d %d %14.8f %14.8f %14.8f %14.8e"

# --- Per-zone temperature computes ---
compute temp_core dyn_core temp
compute temp_dyn_shell1 dyn_shell1 temp
compute temp_dyn_shell2 dyn_shell2 temp
compute temp_dyn_shell3 dyn_shell3 temp
compute temp_dyn_shell4 dyn_shell4 temp

thermo 100
thermo_style custom step temp c_temp_core c_temp_dyn_shell1 c_temp_dyn_shell2 c_temp_dyn_shell3 c_temp_dyn_shell4 etotal pe ke press

run 5000