# Localized thermostat simulation (mode 1)
# Generated by localized_thermostat

units metal
atom_style atomic
boundary p p p

read_data thermostat.data

neighbor 2.0 bin
neigh_modify every 1 delay 0 check yes

pair_style pod
pair_coeff * * HfO2_param.pod HfO2_coefficients.pod Hf O

# --- Group definitions (by atom ID) ---
group core id 2105 2106 2108 2109 2396 2426 2427 2429 2430 2431 2432 2433 2436 2466 2751 2754 2755 2756 4861
group shell1 id 1781 1782 1784 1785 1817 2069 2071 2072 2076 2101 2102 2103 2104 2107 2110 2112 2138 2141 2142 2145 2391 2392 2393 2395 2400 2425 2428 2434 2435 2462 2465 2467 2469 2470 2715 2719 2720 2724 2750 2752 2753 2757 2758 2759 2760 2786 2789 2790 2791 3043 3075 3078 3079 3080
group shell2 id 1457 1458 1460 1461 1493 1744 1745 1746 1747 1748 1749 1752 1777 1778 1779 1780 1783 1786 1788 1813 1814 1818 1820 1821 1822 2036 2065 2066 2067 2068 2070 2073 2075 2098 2111 2113 2116 2137 2139 2143 2144 2146 2148 2178 2360 2389 2390 2394 2397 2398 2399 2404 2422 2423 2437 2440 2458 2461 2463 2464 2468 2471 2472 2502 2684 2714 2716 2717 2718 2721 2723 2746 2747 2749 2764 2785 2787 2792 2793 2794 2795 2796 2826 3039 3040 3042 3044 3047 3048 3074 3076 3077 3081 3082 3083 3084 3110 3111 3113 3114 3115 3116 3118 3367 3399 3402 3403 3404
group shell3 id 1133 1137 1169 1417 1420 1421 1422 1423 1424 1425 1428 1453 1454 1455 1456 1459 1462 1464 1465 1489 1490 1494 1496 1497 1498 1712 1716 1741 1742 1743 1750 1751 1753 1756 1773 1774 1775 1787 1789 1792 1810 1815 1816 1819 1823 1824 1825 1850 1853 1854 1857 2031 2032 2033 2035 2040 2062 2063 2064 2074 2077 2080 2097 2099 2100 2114 2115 2133 2134 2135 2140 2147 2149 2150 2152 2173 2174 2177 2181 2182 2355 2356 2357 2359 2363 2364 2386 2387 2388 2401 2403 2421 2424 2438 2439 2457 2459 2473 2474 2476 2497 2498 2501 2503 2505 2506 2679 2680 2683 2687 2688 2710 2711 2712 2713 2722 2725 2727 2728 2745 2748 2761 2762 2763 2782 2783 2788 2797 2798 2800 2822 2825 2827 2829 2830 3003 3007 3008 3012 3035 3037 3038 3041 3045 3046 3052 3070 3071 3073 3085 3087 3088 3106 3107 3109 3112 3117 3119 3120 3146 3150 3363 3364 3366 3368 3371 3372 3395 3398 3400 3401 3405 3406 3407 3408 3434 3435 3437 3438 3439 3440 3442 3443 3691 3723 3727
group shell4 id 809 1093 1096 1097 1098 1100 1101 1104 1129 1130 1132 1134 1135 1136 1138 1140 1141 1165 1166 1170 1172 1173 1174 1384 1385 1388 1392 1418 1419 1426 1427 1429 1432 1449 1450 1451 1452 1463 1466 1468 1485 1486 1491 1492 1495 1499 1500 1501 1525 1526 1529 1530 1533 1534 1705 1706 1707 1708 1709 1710 1711 1713 1715 1720 1737 1738 1739 1740 1754 1755 1776 1790 1791 1793 1809 1811 1812 1826 1828 1846 1849 1855 1856 1858 1861 2027 2028 2029 2030 2034 2037 2038 2039 2044 2061 2078 2079 2084 2094 2095 2117 2120 2130 2136 2151 2153 2170 2175 2176 2179 2180 2183 2184 2185 2186 2324 2351 2352 2353 2354 2358 2361 2362 2368 2383 2385 2402 2408 2418 2419 2441 2444 2454 2460 2475 2477 2494 2499 2500 2504 2507 2508 2509 2510 2538 2675 2676 2677 2678 2681 2682 2685 2686 2692 2707 2709 2726 2732 2742 2743 2765 2768 2778 2781 2784 2799 2818 2821 2823 2824 2828 2831 2832 2833 2834 2999 3002 3004 3005 3006 3009 3011 3016 3034 3036 3049 3050 3051 3067 3069 3072 3086 3105 3108 3121 3122 3123 3124 3142 3145 3147 3149 3151 3152 3153 3154 3155 3327 3328 3331 3332 3335 3336 3359 3361 3362 3365 3369 3370 3375 3376 3394 3396 3397 3409 3410 3411 3412 3430 3431 3433 3436 3441 3444 3470 3474 3475 3478 3687 3688 3690 3692 3695 3696 3719 3722 3724 3725 3726 3728 3729 3730 3731 3732 3758 3759 3762 3763 3764 3766 3767 4047 4051
group mobile union core shell1 shell2 shell3 shell4
group frozen subtract all mobile

# --- Frozen atoms ---
velocity frozen set 0.0 0.0 0.0
fix freeze frozen setforce 0.0 0.0 0.0
# neigh_modify exclude omitted (crashes with pair_style pod)

# --- Velocity initialization (per-zone, static groups) ---
velocity core create 500.0 64183 dist gaussian
velocity shell1 create 450.0 64184 dist gaussian
velocity shell2 create 350.0 64185 dist gaussian
velocity shell3 create 250.0 64186 dist gaussian
velocity shell4 create 150.0 64187 dist gaussian

# --- Time integration ---
fix integ mobile nve
timestep 0.001

# --- Langevin thermostats ---
fix lang_core core langevin 500.0 500.0 0.1 64283
fix lang_shell1 shell1 langevin 450.0 450.0 0.1 64284
fix lang_shell2 shell2 langevin 350.0 350.0 0.1 64285
fix lang_shell3 shell3 langevin 250.0 250.0 0.1 64286
fix lang_shell4 shell4 langevin 150.0 150.0 0.1 64287

# --- Diagnostics ---
shell mkdir diagnostics
compute ke_per_atom all ke/atom
dump diag_traj mobile custom 500 diagnostics/ke_trajectory.lammpstrj id type x y z c_ke_per_atom
dump_modify diag_traj sort id format line "%d %d %14.8f %14.8f %14.8f %14.8e"

# --- Per-zone temperature computes ---
compute temp_core core temp
compute temp_shell1 shell1 temp
compute temp_shell2 shell2 temp
compute temp_shell3 shell3 temp
compute temp_shell4 shell4 temp

thermo 100
thermo_style custom step temp c_temp_core c_temp_shell1 c_temp_shell2 c_temp_shell3 c_temp_shell4 etotal pe ke press

run 5000